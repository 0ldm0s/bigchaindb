language: python
cache: pip

python:
  - 3.4
  - 3.5
  - 3.6
  
env:
  - TOXENV=flake8
  - TOXENV=docsroot
  - TOXENV=docsserver

matrix:
  fast_finish: true
  exclude:
  - python: 3.4
    env: TOXENV=flake8 
  - python: 3.4
    env: TOXENV=docsroot
  - python: 3.4
    env: TOXENV=docsserver
  - python: 3.5
    env: TOXENV=flake8 
  - python: 3.5 
    env: TOXENV=docsroot
  - python: 3.5 
    env: TOXENV=docsserver
  include:
  - python: 3.4
    addons: 
      rethinkdb: '2.3.5'
    env: BIGCHAINDB_DATABASE_BACKEND=rethinkdb
  - python: 3.5
    addons: 
      rethinkdb: '2.3.5'
    env: BIGCHAINDB_DATABASE_BACKEND=rethinkdb
  - python: 3.5
    env:
    - BIGCHAINDB_DATABASE_BACKEND=mongodb
    - BIGCHAINDB_DATABASE_SSL=
  - python: 3.6
    addons: 
      rethinkdb: '2.3.5'
    env: BIGCHAINDB_DATABASE_BACKEND=rethinkdb
  - python: 3.6
    env:
    - BIGCHAINDB_DATABASE_BACKEND=mongodb
    - BIGCHAINDB_DATABASE_SSL=
  - python: 3.5
    env:
    - BIGCHAINDB_DATABASE_BACKEND=mongodb
    - BIGCHAINDB_DATABASE_SSL=true
    - BIGCHAINDB_DATABASE_CA_CERT=${TRAVIS_BUILD_DIR}/tests/backend/mongodb-ssl/certs/ca.crt
    - BIGCHAINDB_DATABASE_CRLFILE=${TRAVIS_BUILD_DIR}/tests/backend/mongodb-ssl/certs/crl.pem
    - BIGCHIANDB_DATABASE_CERTFILE=${TRAVIS_BUILD_DIR}/tests/backend/mongodb-ssl/certs/test_bdb_ssl.crt
    - BIGCHAINDB_DATABASE_KEYFILE=${TRAVIS_BUILD_DIR}/tests/backend/mongodb-ssl/certs/test_bdb_ssl.key
    - BIGCHAINDB_DATABASE_KEYFILE_PASSPHRASE=
  - python: 3.6
    env:
    - BIGCHAINDB_DATABASE_BACKEND=mongodb
    - BIGCHAINDB_DATABASE_SSL=true
    - BIGCHAINDB_DATABASE_CA_CERT=${TRAVIS_BUILD_DIR}/tests/backend/mongodb-ssl/certs/ca.crt
    - BIGCHAINDB_DATABASE_CRLFILE=${TRAVIS_BUILD_DIR}/tests/backend/mongodb-ssl/certs/crl.pem
    - BIGCHIANDB_DATABASE_CERTFILE=${TRAVIS_BUILD_DIR}/tests/backend/mongodb-ssl/certs/test_bdb_ssl.crt
    - BIGCHAINDB_DATABASE_KEYFILE=${TRAVIS_BUILD_DIR}/tests/backend/mongodb-ssl/certs/test_bdb_ssl.key
    - BIGCHAINDB_DATABASE_KEYFILE_PASSPHRASE=

before_install: sudo .ci/travis-before-install.sh

install: .ci/travis-install.sh

before_script: .ci/travis-before-script.sh

script: .ci/travis_script.sh

after_success: .ci/travis-after-success.sh
